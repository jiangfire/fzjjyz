# æ¶æ„æ–‡æ¡£

æœ¬æ–‡æ¡£æè¿° fzj çš„ç³»ç»Ÿæ¶æ„ã€æ¨¡å—è®¾è®¡å’Œå®ç°ç»†èŠ‚ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLI å±‚ (cmd/fzj)                   â”‚
â”‚  encrypt | decrypt | encrypt-dir | decrypt-dir              â”‚
â”‚  keygen | keymanage | info | version                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ¸å¿ƒå±‚ (internal/crypto)                  â”‚
â”‚  operations | keyfile | keygen | hybrid | signature         â”‚
â”‚  archive (ç›®å½•æ‰“åŒ…) | stream_encrypt | stream_decrypt       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ¼å¼å±‚ (internal/format)                  â”‚
â”‚  header | parser | serialization                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å·¥å…·å±‚ (internal/utils)                   â”‚
â”‚  errors | logger | buffer_pool                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å›½é™…åŒ–å±‚ (internal/i18n)                  â”‚
â”‚  i18n | cobra integration | zh_CN / en_US                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–°å¢åŠŸèƒ½æ¨¡å— (v0.2.0)

#### ç›®å½•åŠ å¯†/è§£å¯†æµç¨‹
```
ç›®å½• â†’ ZIP æ‰“åŒ… â†’ åŠ å¯† â†’ .fzj æ–‡ä»¶
  â†“
.fzj æ–‡ä»¶ â†’ è§£å¯† â†’ ZIP è§£å‹ â†’ æ¢å¤ç›®å½•
```

#### å›½é™…åŒ–ç³»ç»Ÿ
```
LANG ç¯å¢ƒå˜é‡ â†’ è‡ªåŠ¨æ£€æµ‹ â†’ é€‰æ‹©å­—å…¸ â†’ ç¿»è¯‘è¾“å‡º
  â†“
æ”¯æŒ: zh_CN (é»˜è®¤) / en_US
```

## ğŸ“¦ æ¨¡å—è¯¦è§£

### 1. å¯†ç å­¦æ ¸å¿ƒ (internal/crypto)

#### archive.go - ç›®å½•å½’æ¡£ (v0.2.0 æ–°å¢)

**èŒè´£**: ç›®å½•æ‰“åŒ…å’Œè§£å‹ï¼Œæ”¯æŒè·¯å¾„éå†é˜²æŠ¤

```go
func CreateZipFromDirectory(dir string, w io.Writer, opts *ArchiveOptions) error
func ExtractZipToDirectory(data []byte, outputDir string) error
func GetZipSize(data []byte) (int64, error)
func CountZipFiles(data []byte) (int, error)
```

**å®‰å…¨ç‰¹æ€§**:
- âœ… è·¯å¾„éå†æ£€æµ‹ (`..` å’Œç»å¯¹è·¯å¾„)
- âœ… ç›®å½•æƒé™éªŒè¯
- âœ… æ–‡ä»¶æ•°é‡é™åˆ¶ (å¯é€‰)

**ä½¿ç”¨æµç¨‹**:
```
ç›®å½•åŠ å¯†:
  dir/ â†’ CreateZipFromDirectory â†’ ZIPç¼“å†²åŒº â†’ Encrypt â†’ .fzj

ç›®å½•è§£å¯†:
  .fzj â†’ Decrypt â†’ ZIPç¼“å†²åŒº â†’ ExtractZipToDirectory â†’ dir/
```

#### keyfile.go - å¯†é’¥æ–‡ä»¶ç®¡ç† + ç¼“å­˜ç³»ç»Ÿ

**æ–°å¢ç¼“å­˜åŠŸèƒ½** (v0.2.0):
```go
type KeyCache struct {
    cache      sync.Map
    mu         sync.RWMutex
    hitCount   uint64
    loadCount  uint64
    maxEntries int
    ttl        time.Duration
}

func LoadPublicKeyCached(path string) (kem.PublicKey, error)
func LoadPrivateKeyCached(path string) (kem.PrivateKey, error)
func GetCacheInfo() CacheInfo
```

**ç¼“å­˜ç‰¹æ€§**:
- TTL: 1 å°æ—¶è‡ªåŠ¨è¿‡æœŸ
- å¤§å°é™åˆ¶: æœ€å¤š 100 ä¸ªå¯†é’¥
- åå°æ¸…ç†: æ¯ 5 åˆ†é’Ÿ
- çº¿ç¨‹å®‰å…¨: sync.Map
- ç»Ÿè®¡ä¿¡æ¯: å‘½ä¸­ç‡ã€åŠ è½½æ¬¡æ•°

#### hybrid.go - æ··åˆåŠ å¯†ç³»ç»Ÿ

**èŒè´£**: Kyber768 + ECDH åŒé‡å¯†é’¥å°è£…

```go
type HybridEncryptor struct {
    kyberPub kem.PublicKey
    ecdhPub  *ecdh.PublicKey
}

func (e *HybridEncryptor) Encapsulate() (
    encapsulated []byte,  // Kyber å¯†æ–‡
    ecdhPub []byte,       // ä¸´æ—¶ ECDH å…¬é’¥
    sharedSecret []byte,  // ç»„åˆå…±äº«å¯†é’¥ (32å­—èŠ‚)
    error
)
```

**å¯†é’¥æ´¾ç”Ÿæµç¨‹**:
```
Kyber å¯†æ–‡ + ECDH å…¬é’¥
    â†“
Kyber è§£å°è£… â†’ Kyber å…±äº«å¯†é’¥ (32å­—èŠ‚)
ECDH å¯†é’¥äº¤æ¢ â†’ ECDH å…±äº«å¯†é’¥ (32å­—èŠ‚)
    â†“
SHA256(Kyberå¯†é’¥ || ECDHå¯†é’¥) â†’ æœ€ç»ˆå¯†é’¥ (32å­—èŠ‚)
```

#### signature.go - ç­¾åç³»ç»Ÿ

**èŒè´£**: Dilithium3 ç­¾åå’ŒéªŒè¯

```go
func SignHash(hash []byte, priv interface{}) ([]byte, error)
func VerifyHashSignature(hash []byte, sig []byte, pub interface{}) (bool, error)
```

**ç‰¹ç‚¹**:
- æ”¯æŒå¯é€‰ç­¾åï¼ˆnil è¡¨ç¤ºè·³è¿‡ï¼‰
- Dilithium3 æ¨¡å¼ 3 (å®‰å…¨çº§åˆ« 3)

#### operations_shared.go - å…±äº«æ“ä½œåº“

**èŒè´£**: æ¶ˆé™¤ä»£ç é‡å¤çš„æ ¸å¿ƒå‡½æ•°

**æå–çš„å‡½æ•°**:
- `prepareEncryptionKeys()` - å¯†é’¥å‡†å¤‡
- `encryptAESGCM()` / `decryptAESGCM()` - AES åŠ è§£å¯†
- `calculateHash()` - SHA256 å“ˆå¸Œ
- `signHash()` / `verifyHashSignature()` - ç­¾å
- `buildFileHeader()` - æ„å»ºæ–‡ä»¶å¤´
- `writeEncryptedFile()` / `parseEncryptedFile()` - æ–‡ä»¶ I/O
- `EncryptFileCore()` - æ ¸å¿ƒåŠ å¯†é€»è¾‘
- `DecryptFileCore()` - æ ¸å¿ƒè§£å¯†é€»è¾‘

#### operations.go - æ ‡å‡†æ–‡ä»¶æ“ä½œ

**èŒè´£**: æä¾›ç®€æ´çš„åŠ å¯†/è§£å¯†æ¥å£

```go
func EncryptFile(inputPath, outputPath string, kyberPub, ecdhPub, dilithiumPriv) error
func DecryptFile(inputPath, outputPath string, kyberPriv, ecdhPriv, dilithiumPub) error
```

**è°ƒç”¨æµç¨‹**:
```
EncryptFile
  â†“
EncryptFileCore (å…±äº«)
  â”œâ”€â”€ è¯»å–æ–‡ä»¶
  â”œâ”€â”€ å¯†é’¥å°è£…
  â”œâ”€â”€ AES-GCM åŠ å¯†
  â”œâ”€â”€ è®¡ç®—å“ˆå¸Œ
  â”œâ”€â”€ ç­¾å
  â””â”€â”€ æ„å»ºå¤´éƒ¨
  â†“
serializeHeader
  â†“
writeEncryptedFile
```

#### operations_stream.go - æµå¼æ“ä½œæ¥å£

**èŒè´£**: æä¾›æµå¼å¤„ç†çš„ç»Ÿä¸€æ¥å£

```go
func EncryptFileStreaming(...) error
func DecryptFileStreaming(...) error
func EncryptFileStreamingAuto(...) error  // è‡ªåŠ¨ç¼“å†²åŒº
func DecryptFileStreamingAuto(...) error
```

**ç‰¹ç‚¹**:
- è°ƒç”¨ç›¸åŒçš„ `EncryptFileCore`
- æä¾›ç¼“å†²åŒºå¤§å°æ§åˆ¶
- è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç¼“å†²åŒº

#### stream_encrypt.go / stream_decrypt.go - æµå¼å¤„ç†å™¨

**èŒè´£**: å°è£…æµå¼å¤„ç†é€»è¾‘

**é‡è¦è¯´æ˜**:
```
âš ï¸ ä¼ªæµå¼å®ç°
ç”±äº AES-GCM éœ€è¦å®Œæ•´æ•°æ®ç”Ÿæˆè®¤è¯æ ‡ç­¾ï¼Œ
å½“å‰å®ç°ä»éœ€è¯»å–æ•´ä¸ªæ–‡ä»¶åˆ°å†…å­˜ã€‚

çœŸæ­£çš„æµå¼éœ€è¦ä½¿ç”¨ AES-CTR + HMAC
```

**ç¼“å†²åŒºæ± ä¼˜åŒ–**:
```go
type BufferPool struct {
    pool sync.Pool
    size int
}
```

#### keyfile.go - å¯†é’¥ç®¡ç†

**èŒè´£**: å¯†é’¥æ–‡ä»¶çš„è¯»å†™å’Œç¼“å­˜

**ç¼“å­˜æœºåˆ¶**:
```go
type keyCacheEntry struct {
    key       interface{}
    createdAt time.Time
    ttl       time.Duration
}

const (
    MaxCacheSize = 100          // æœ€å¤§ç¼“å­˜æ•°
    DefaultCacheTTL = 1 * time.Hour
    CacheCleanupInterval = 5 * time.Minute
)
```

**å®‰å…¨ç‰¹æ€§**:
- ç§é’¥æ–‡ä»¶æƒé™æ£€æŸ¥ (0600)
- TTL è‡ªåŠ¨è¿‡æœŸ
- å¤§å°é™åˆ¶é˜²æ­¢å†…å­˜æ³„æ¼
- åå°è‡ªåŠ¨æ¸…ç†

#### keygen.go - å¯†é’¥ç”Ÿæˆ

**èŒè´£**: ç”Ÿæˆå„ç§å¯†é’¥å¯¹

**å¹¶è¡Œç”Ÿæˆ**:
```go
func GenerateKeyPairParallel() (
    kyberPub, kyberPriv,
    ecdhPub, ecdhPriv,
    dilithiumPub, dilithiumPriv,
    error
)
```

**æµç¨‹**:
```
å¯åŠ¨ 3 ä¸ª goroutine
  â”œâ”€â”€ Kyber ç”Ÿæˆ
  â”œâ”€â”€ ECDH ç”Ÿæˆ
  â””â”€â”€ Dilithium ç”Ÿæˆ
  â†“
ç­‰å¾…æ‰€æœ‰å®Œæˆ (sync.WaitGroup)
  â†“
è¿”å›ç»“æœ
```

### 2. æ–‡ä»¶æ ¼å¼ (internal/format)

#### header.go - æ–‡ä»¶å¤´ç»“æ„

**æ ¼å¼å®šä¹‰**:
```
æ–‡ä»¶å¤´ (çº¦ 4.5KB)
â”œâ”€â”€ ç‰ˆæœ¬ (1å­—èŠ‚)
â”œâ”€â”€ æ–‡ä»¶åé•¿åº¦ (1å­—èŠ‚)
â”œâ”€â”€ æ–‡ä»¶å (å˜é•¿)
â”œâ”€â”€ æ–‡ä»¶å¤§å° (8å­—èŠ‚)
â”œâ”€â”€ Kyber å¯†æ–‡é•¿åº¦ (2å­—èŠ‚)
â”œâ”€â”€ Kyber å¯†æ–‡ (1088å­—èŠ‚)
â”œâ”€â”€ ECDH å…¬é’¥ (32å­—èŠ‚)
â”œâ”€â”€ IV (12å­—èŠ‚)
â”œâ”€â”€ ç­¾åé•¿åº¦ (2å­—èŠ‚)
â”œâ”€â”€ ç­¾å (2700å­—èŠ‚)
â”œâ”€â”€ SHA256 å“ˆå¸Œ (32å­—èŠ‚)
â””â”€â”€ æ—¶é—´æˆ³ (8å­—èŠ‚)
```

**åºåˆ—åŒ–ä¼˜åŒ–**:
- æ ‡å‡†æ–¹æ³•: ä½¿ç”¨ binary.Write
- ä¼˜åŒ–æ–¹æ³•: æ‰‹åŠ¨å­—èŠ‚æ“ä½œ
- æ€§èƒ½æå‡: 5x

#### parser.go - è§£æå™¨

**èŒè´£**: ä»å­—èŠ‚æµè§£ææ–‡ä»¶å¤´

```go
func ParseFileHeaderFromBytes(data []byte) (*FileHeader, error)
func ParseFileHeader(reader io.Reader) (*FileHeader, error)
```

### 3. å·¥å…·å±‚ (internal/utils)

#### errors.go - é”™è¯¯ç³»ç»Ÿ

**é”™è¯¯ç å®šä¹‰**:
```go
const (
    ErrInvalidParameter = 1001
    ErrInvalidKey       = 1002
    ErrInvalidFormat    = 1003
    ErrIOError          = 2001
    ErrEncryptionFailed = 3001
    ErrDecryptionFailed = 3002
    ErrHashMismatch     = 4001
    ErrVerificationFailed = 4002
    ErrSigningFailed    = 4003
    ErrKeyGenerationFailed = 5001
    ErrSerializationFailed = 5002
    ErrAuthFailed       = 6001
)
```

#### buffer_pool.go - ç¼“å†²åŒºæ± 

**èŒè´£**: ä¼˜åŒ–å†…å­˜åˆ†é…

```go
type BufferPool struct {
    pool sync.Pool
    size int
}

func NewBufferPool(size int) *BufferPool
func (p *BufferPool) Get() []byte
func (p *BufferPool) Put(b []byte)
```

## ğŸ” å®‰å…¨æ¶æ„

### 1. å¯†é’¥å®‰å…¨

```
å¯†é’¥ç”Ÿæˆ
  â†“
å†…å­˜ä¸­ä½¿ç”¨
  â†“
åŠ å¯†/è§£å¯†å®Œæˆ
  â†“
é›¶åŒ–æ•æ„Ÿæ•°æ® (è®¡åˆ’ä¸­)
  â†“
è¿”å›ç»“æœ
```

**å½“å‰å®ç°**:
- âœ… ç§é’¥æ–‡ä»¶ 0600 æƒé™
- âœ… å¯†é’¥ç¼“å­˜ TTL
- âœ… ç¼“å­˜å¤§å°é™åˆ¶
- ğŸ”„ å†…å­˜é›¶åŒ– (å¾…å®ç°)

### 2. æ•°æ®å®Œæ•´æ€§

```
åŠ å¯†æµç¨‹:
  1. è¯»å–æ˜æ–‡
  2. è®¡ç®— SHA256(æ˜æ–‡)
  3. åŠ å¯†æ•°æ®
  4. Dilithium ç­¾å(å“ˆå¸Œ)
  5. å†™å…¥: å¤´éƒ¨ + å¯†æ–‡

è§£å¯†æµç¨‹:
  1. è¯»å–å¤´éƒ¨
  2. éªŒè¯å¤´éƒ¨æ ¼å¼
  3. è§£å¯†æ•°æ®
  4. è®¡ç®— SHA256(æ˜æ–‡)
  5. éªŒè¯å“ˆå¸ŒåŒ¹é…
  6. éªŒè¯ç­¾å (å¦‚æœæä¾›)
```

### 3. è®¤è¯åŠ å¯†

```
AES-256-GCM
â”œâ”€â”€ æœºå¯†æ€§: AES-CTR æ¨¡å¼
â”œâ”€â”€ å®Œæ•´æ€§: GMAC è®¤è¯æ ‡ç­¾
â””â”€â”€ éšæœºæ€§: 12å­—èŠ‚éšæœº Nonce
```

## ğŸ”„ æ•°æ®æµ

### åŠ å¯†æµç¨‹

```
ç”¨æˆ·è¾“å…¥: plaintext.txt
  â†“
CLI: encrypt å‘½ä»¤
  â†“
LoadPublicKeyCached (ç¼“å­˜)
  â†“
LoadDilithiumPrivateKeyCached (ç¼“å­˜)
  â†“
EncryptFileStreamingAuto
  â†“
EncryptFileCore
  â”œâ”€â”€ è¯»å–æ–‡ä»¶ (10MB)
  â”œâ”€â”€ å¯†é’¥å°è£… (Kyber + ECDH)
  â”œâ”€â”€ AES-GCM åŠ å¯† (10MB â†’ 10MB)
  â”œâ”€â”€ SHA256 å“ˆå¸Œ (10MB)
  â”œâ”€â”€ Dilithium ç­¾å
  â”œâ”€â”€ æ„å»ºå¤´éƒ¨ (4.5KB)
  â””â”€â”€ å†™å…¥æ–‡ä»¶
  â†“
è¾“å‡º: plaintext.fzj (10MB + 4.5KB)
```

### è§£å¯†æµç¨‹

```
ç”¨æˆ·è¾“å…¥: plaintext.fzj
  â†“
CLI: decrypt å‘½ä»¤
  â†“
è¯»å–æ–‡ä»¶å¤´ (4.5KB)
  â†“
LoadPrivateKeyCached (ç¼“å­˜)
  â†“
LoadDilithiumPublicKeyCached (ç¼“å­˜)
  â†“
DecryptFileCore
  â”œâ”€â”€ è§£æå¤´éƒ¨
  â”œâ”€â”€ å¯†é’¥è§£å°è£…
  â”œâ”€â”€ AES-GCM è§£å¯†
  â”œâ”€â”€ éªŒè¯å“ˆå¸Œ
  â”œâ”€â”€ éªŒè¯ç­¾å
  â””â”€â”€ å†™å…¥æ˜æ–‡
  â†“
è¾“å‡º: plaintext.txt
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç‚¹

### 1. ç¼“å­˜ä¼˜åŒ–

**é—®é¢˜**: é¢‘ç¹è¯»å–ç£ç›˜

**è§£å†³**: å†…å­˜ç¼“å­˜ + TTL

**æ•ˆæœ**: 1000x åŠ é€Ÿ

### 2. å¹¶è¡Œä¼˜åŒ–

**é—®é¢˜**: å¯†é’¥ç”Ÿæˆä¸²è¡Œ

**è§£å†³**: 3 ä¸ª goroutine å¹¶è¡Œ

**æ•ˆæœ**: 2-3x åŠ é€Ÿ

### 3. åºåˆ—åŒ–ä¼˜åŒ–

**é—®é¢˜**: binary.Write æ€§èƒ½å·®

**è§£å†³**: æ‰‹åŠ¨å­—èŠ‚æ“ä½œ

**æ•ˆæœ**: 5x åŠ é€Ÿ

### 4. ç¼“å†²åŒºæ± 

**é—®é¢˜**: é¢‘ç¹åˆ†é…/é‡Šæ”¾å†…å­˜

**è§£å†³**: sync.Pool é‡ç”¨

**æ•ˆæœ**: å‡å°‘ GC å‹åŠ›

## ğŸ¯ è®¾è®¡å†³ç­–

### ä¸ºä»€ä¹ˆä½¿ç”¨ AES-GCM?

**ä¼˜ç‚¹**:
- âœ… æ ‡å‡†åŒ– (NIST)
- âœ… è®¤è¯åŠ å¯† (AEAD)
- âœ… ç¡¬ä»¶åŠ é€Ÿæ”¯æŒ
- âœ… æ€§èƒ½ä¼˜ç§€

**ç¼ºç‚¹**:
- âŒ éœ€è¦å®Œæ•´æ•°æ®
- âŒ æ— æ³•çœŸæ­£æµå¼

**æ›¿ä»£æ–¹æ¡ˆ** (æœªæ¥):
- AES-CTR + HMAC-SHA256
- æ”¯æŒçœŸæ­£çš„æµå¼å¤„ç†

### ä¸ºä»€ä¹ˆä½¿ç”¨æ··åˆåŠ å¯†?

**åŸå› **:
1. **åé‡å­å®‰å…¨**: Kyber æŠµæŠ—é‡å­æ”»å‡»
2. **ä¼ ç»Ÿå®‰å…¨**: ECDH æˆç†Ÿå¯é 
3. **åŒé‡ä¿é™©**: ä¸¤è€…åŒæ—¶è¢«ç ´è§£æ¦‚ç‡æä½
4. **æ€§èƒ½å¹³è¡¡**: Kyber å¯†æ–‡è¾ƒå¤§ä½†è§£å¯†å¿«

### ä¸ºä»€ä¹ˆéœ€è¦ Dilithium ç­¾å?

**åŸå› **:
1. **æ¥æºè®¤è¯**: ç¡®è®¤æ–‡ä»¶åˆ›å»ºè€…
2. **å®Œæ•´æ€§**: é˜²æ­¢ç¯¡æ”¹
3. **ä¸å¯å¦è®¤**: å‘é€è€…æ— æ³•å¦è®¤
4. **åé‡å­å®‰å…¨**: æŠµæŠ—é‡å­æ”»å‡»

## ğŸ”® æœªæ¥æ¶æ„

### v0.3.0: ç¡¬ä»¶åŠ é€Ÿ (è®¡åˆ’ä¸­)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CPU ç‰¹æ€§æ£€æµ‹                   â”‚
â”‚  (AES-NI, SHA-NI)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜è·¯å¾„               â”‚
â”‚  - ç¡¬ä»¶åŠ é€Ÿ                    â”‚
â”‚  - è½¯ä»¶å®ç°                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### v0.4.0: çœŸæ­£æµå¼ (è®¡åˆ’ä¸­)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AES-CTR + HMAC-SHA256         â”‚
â”‚  - å—çº§åŠ å¯†                    â”‚
â”‚  - å¹¶è¡Œ HMAC                   â”‚
â”‚  - O(ç¼“å†²åŒº) å†…å­˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### v0.5.0: é›¶æ‹·è´ (è®¡åˆ’ä¸­)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  io.CopyBuffer                 â”‚
â”‚  - ç›´æ¥å†™å…¥è¾“å‡º                â”‚
â”‚  - å‡å°‘ä¸­é—´ç¼“å†²åŒº              â”‚
â”‚  - å†…å­˜æ˜ å°„æ–‡ä»¶ (å¤§æ–‡ä»¶)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª æµ‹è¯•æ¶æ„

### å•å…ƒæµ‹è¯•

```
internal/crypto/
â”œâ”€â”€ hybrid_test.go          # æ··åˆåŠ å¯†æµ‹è¯•
â”œâ”€â”€ signature_test.go       # ç­¾åæµ‹è¯•
â”œâ”€â”€ operations_test.go      # æ–‡ä»¶æ“ä½œæµ‹è¯•
â”œâ”€â”€ stream_test.go          # æµå¼æµ‹è¯•
â””â”€â”€ benchmark_test.go       # åŸºå‡†æµ‹è¯•
```

### é›†æˆæµ‹è¯•

```
cmd/fzj/
â””â”€â”€ main_test.go            # CLI é›†æˆæµ‹è¯•
```

### æ€§èƒ½æµ‹è¯•

```bash
go test -bench=. -benchmem ./internal/crypto/
```

### 4. å›½é™…åŒ–æ¨¡å— (internal/i18n) - v0.2.0 æ–°å¢

#### i18n.go - æ ¸å¿ƒç¿»è¯‘ç³»ç»Ÿ

**èŒè´£**: å¤šè¯­è¨€æ”¯æŒå’Œç¿»è¯‘ç®¡ç†

```go
type Dictionary map[string]string

var (
    globalDict Dictionary
    currentLang string
    once        sync.Once
)

func Init(lang string) error
func T(key string, args ...interface{}) string
func Get(key string) string
func SetLanguage(lang string) error
func GetLanguage() string
func TranslateError(key string, args ...interface{}) error
```

**æ”¯æŒè¯­è¨€**:
- `zh_CN` - ç®€ä½“ä¸­æ–‡ (é»˜è®¤)
- `en_US` - English

**ç¿»è¯‘å­—å…¸ç»“æ„**:
```go
{
    "encrypt.short": "åŠ å¯†æ–‡ä»¶",
    "decrypt.short": "è§£å¯†æ–‡ä»¶",
    "keygen.short": "ç”Ÿæˆå¯†é’¥",
    "status.success_encrypt": "âœ… åŠ å¯†æˆåŠŸï¼",
    "error.file_not_exists": "æ–‡ä»¶ä¸å­˜åœ¨: %s",
    // ... æ›´å¤šç¿»è¯‘
}
```

#### cobra.go - Cobra CLI é›†æˆ

**èŒè´£**: è‡ªåŠ¨ç¿»è¯‘ CLI å¸®åŠ©ä¿¡æ¯

```go
func AddCommandTranslations(cmd *cobra.Command)
func TranslateUsage(cmd *cobra.Command)
```

**è‡ªåŠ¨ç¿»è¯‘**:
- å‘½ä»¤æè¿°
- å‚æ•°è¯´æ˜
- å¸®åŠ©ä¿¡æ¯
- é”™è¯¯æ¶ˆæ¯

#### å®‰å…¨è€ƒè™‘

**æ ¼å¼å­—ç¬¦ä¸²å®‰å…¨**:
```go
// âŒ å±é™© - å¯èƒ½å¯¼è‡´æ³¨å…¥
fmt.Printf(i18n.T(key) + "\n")

// âœ… å®‰å…¨ - ä½¿ç”¨ Get() æˆ–ä¸­é—´å˜é‡
fmt.Printf("%s\n", i18n.Get(key))
msg := i18n.T(key)
fmt.Printf("%s\n", msg)
```

**å¹¶å‘å®‰å…¨**:
- `sync.Once` ç¡®ä¿å•æ¬¡åˆå§‹åŒ–
- `sync.Map` ä¿è¯çº¿ç¨‹å®‰å…¨
- åªè¯»å­—å…¸ï¼Œæ— ç«æ€æ¡ä»¶

## ğŸ“¦ ä¾èµ–å…³ç³»

```
fzj
â”œâ”€â”€ Go æ ‡å‡†åº“
â”‚   â”œâ”€â”€ crypto/ecdh
â”‚   â”œâ”€â”€ crypto/sha256
â”‚   â”œâ”€â”€ encoding/binary
â”‚   â”œâ”€â”€ encoding/pem
â”‚   â”œâ”€â”€ archive/zip (v0.2.0)
â”‚   â”œâ”€â”€ io
â”‚   â”œâ”€â”€ sync
â”‚   â”œâ”€â”€ time
â”‚   â””â”€â”€ strings
â”‚
â”œâ”€â”€ Cloudflare CIRCL
â”‚   â”œâ”€â”€ github.com/cloudflare/circl/kem (Kyber768)
â”‚   â””â”€â”€ github.com/cloudflare/circl/sign/dilithium/mode3
â”‚
â”œâ”€â”€ Cobra CLI
â”‚   â””â”€â”€ github.com/spf13/cobra
â”‚
â””â”€â”€ è¿›åº¦æ¡ (å¯é€‰)
    â””â”€â”€ github.com/schollz/progressbar/v3
```

## ğŸ“ è®¾è®¡æ¨¡å¼

### 1. å·¥å‚æ¨¡å¼

```go
func NewStreamingEncryptor(...) (*StreamingEncryptor, error)
func NewHybridEncryptor(...) *HybridEncryptor
```

### 2. ç­–ç•¥æ¨¡å¼

```go
// æ ‡å‡† vs æµå¼
EncryptFile(...)          // æ ‡å‡†
EncryptFileStreaming(...) // æµå¼
```

### 3. æ± æ¨¡å¼

```go
type BufferPool struct {
    pool sync.Pool
}
```

### 4. å•ä¾‹æ¨¡å¼ (ç¼“å­˜)

```go
var keyCache sync.Map  // å…¨å±€å…±äº«ç¼“å­˜
```

## ğŸ” è°ƒè¯•å’Œç›‘æ§

### æ—¥å¿—

```go
// internal/utils/logger.go (è®¡åˆ’ä¸­)
Logger.Debug("åŠ å¯†å¼€å§‹")
Logger.Info("å¯†é’¥åŠ è½½å®Œæˆ")
Logger.Warn("ç¼“å­˜æ¥è¿‘ä¸Šé™")
Logger.Error("åŠ å¯†å¤±è´¥", err)
```

### æŒ‡æ ‡

```go
// è®¡åˆ’æ·»åŠ 
type Metrics struct {
    EncryptionTime    time.Duration
    DecryptionTime    time.Duration
    CacheHitRate      float64
    MemoryUsage       uint64
    FilesProcessed    uint64
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.1
**æœ€åæ›´æ–°**: 2025-12-31
**å½“å‰ç‰ˆæœ¬**: v0.2.0 (å·²å‘å¸ƒ)
**ç»´æŠ¤è€…**: fzj å¼€å‘å›¢é˜Ÿ
